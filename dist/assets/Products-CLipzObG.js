import{r,j as e,L as b}from"./index-Bh_G82eR.js";import{a as m}from"./admin.service-DANvCZDH.js";import{J as N,d as v,M as w,N as k}from"./index.esm-BGr2I2xK.js";import"./iconBase-D0Fi-Wjo.js";function C(){const[u,o]=r.useState([]),[h,x]=r.useState(!0),[i,p]=r.useState(""),[t,y]=r.useState({page:1,limit:20,total:0,pages:1}),[c,f]=r.useState({status:""}),n=r.useCallback(async(s=1)=>{var l;x(!0);try{console.log("Fetching products with filters:",{search:i,status:c.status,page:s,limit:t.limit});const a=await m.getProducts({search:i,status:c.status,page:s,limit:t.limit});console.log("Products API response:",a),(l=a.data)!=null&&l.products?(console.log("Products found:",a.data.products.length),o(a.data.products),y(a.data.pagination)):Array.isArray(a.data)?(console.log("Products array found directly:",a.data.length),o(a.data)):(console.warn("Unexpected products data structure:",a),o([]))}catch(a){console.error("Failed to fetch products:",a)}finally{x(!1)}},[i,c.status,t.limit]);r.useEffect(()=>{const s=setTimeout(()=>{n(1)},500);return()=>clearTimeout(s)},[n]);const g=s=>{s>=1&&s<=t.pages&&n(s)},j=async s=>{try{await m.toggleProductStatus(s._id,s.status),n(t.page)}catch(l){console.error("Failed to update product status:",l)}},d=u;return h?e.jsx("div",{className:"p-6 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Products Management"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Review and manage platform products"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("select",{value:c.status,onChange:s=>f(l=>({...l,status:s.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",value:i,onChange:s=>p(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-64"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Store"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[d.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.images&&s.images.length>0?e.jsx("img",{src:s.images[0],alt:s.name,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg text-gray-500",children:e.jsx(v,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:typeof s.category=="object"&&s.category!==null?s.category.name:s.category})]})]})}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:s.storeName}),e.jsxs("td",{className:"px-6 py-4 font-medium text-gray-900",children:["â‚¦",s.price.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.stock===0?"bg-red-100 text-red-700":s.stock<=20?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:s.stock===0?"Out of Stock":s.stock<=20?`Low (${s.stock})`:`${s.stock}`})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(b,{to:`/dashboard/products/${s._id}`,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Details"}),e.jsx("button",{onClick:()=>j(s),className:"text-gray-500 hover:text-blue-600 transition",title:s.status==="active"?"Deactivate":"Activate",children:s.status==="active"?e.jsx(w,{}):e.jsx(k,{})})]})})]},s._id)),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No products found."})})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:d.length})," of ",e.jsx("span",{className:"font-medium",children:t.total})," products"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(t.page-1),disabled:t.page<=1,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",t.page," of ",t.pages]}),e.jsx("button",{onClick:()=>g(t.page+1),disabled:t.page>=t.pages,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]})]})}export{C as default};
