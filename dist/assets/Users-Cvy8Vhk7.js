import{r as l,j as e,L as C}from"./index-Bh_G82eR.js";import{a as b}from"./admin.service-DANvCZDH.js";import{J as U,x as y,L as o,O as V,g as j}from"./index.esm-BGr2I2xK.js";import"./iconBase-D0Fi-Wjo.js";function R(){const[g,n]=l.useState([]),[f,p]=l.useState(!0),[c,N]=l.useState(""),[a,v]=l.useState({page:1,limit:20,total:0,pages:1}),[i,u]=l.useState({role:"",status:""}),d=l.useCallback(async(s=1)=>{var t;p(!0);try{const r=await b.getUsers({search:c,role:i.role,status:i.status,page:s,limit:a.limit});(t=r.data)!=null&&t.users?(n(r.data.users),v(r.data.pagination)):Array.isArray(r.data)?n(r.data):n([])}catch(r){console.error("Failed to fetch users:",r)}finally{p(!1)}},[c,i,a.limit]);l.useEffect(()=>{d(1)},[i,d]),l.useEffect(()=>{const s=setTimeout(()=>{d(1)},500);return()=>clearTimeout(s)},[c,d]);const h=s=>{s>=1&&s<=a.pages&&d(s)},w=async s=>{try{await b.toggleUserStatus(s._id,s.isActive),n(g.map(t=>t._id===s._id?{...t,isActive:!t.isActive}:t))}catch(t){console.error("Failed to update user status:",t),d(a.page)}},x=g,A=s=>{const t=(s==null?void 0:s.status)||"unverified",r=(s==null?void 0:s.bvnVerified)||(s==null?void 0:s.ninVerified)||(s==null?void 0:s.votersVerified),S={verified:"bg-green-100 text-green-700",pending:"bg-yellow-100 text-yellow-700",rejected:"bg-red-100 text-red-700",unverified:"bg-gray-100 text-gray-700",locked:"bg-orange-100 text-orange-700",failed:"bg-red-100 text-red-700"},k={verified:e.jsx(y,{className:"mr-1"}),pending:e.jsx(j,{className:"mr-1"}),rejected:e.jsx(o,{className:"mr-1"}),unverified:e.jsx(o,{className:"mr-1"}),locked:e.jsx(j,{className:"mr-1"}),failed:e.jsx(o,{className:"mr-1"})},m=r?"verified":t;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${S[m]}`,children:[k[m],m]})};return f?e.jsx("div",{className:"p-6 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Users Management"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Manage all platform users"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("select",{value:i.role,onChange:s=>u(t=>({...t,role:s.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"USERS",children:"Users"}),e.jsx("option",{value:"VENDORS",children:"Vendors"}),e.jsx("option",{value:"ADMIN",children:"Admins"})]}),e.jsxs("select",{value:i.status,onChange:s=>u(t=>({...t,status:s.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:c,onChange:s=>N(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-64"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Verification"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[x.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold shrink-0",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.role==="ADMIN"?"bg-purple-100 text-purple-700":s.role==="VENDORS"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.role})}),e.jsx("td",{className:"px-6 py-4",children:A(s.verification)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${s.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[s.isActive?e.jsx(y,{className:"mr-1"}):e.jsx(o,{className:"mr-1"}),s.isActive?"Active":"Inactive"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs(C,{to:`/dashboard/users/${s._id}`,className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 text-sm",children:["Details ",e.jsx(V,{})]}),e.jsx("button",{onClick:()=>w(s),className:`text-sm font-medium px-3 py-1 rounded-md transition ${s.isActive?"text-red-600 hover:bg-red-50":"text-green-600 hover:bg-green-50"}`,children:s.isActive?"Suspend":"Activate"})]})})]},s._id)),x.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No users found matching your search."})})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:x.length})," of ",e.jsx("span",{className:"font-medium",children:a.total})," users"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h(a.page-1),disabled:a.page<=1,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",a.page," of ",a.pages]}),e.jsx("button",{onClick:()=>h(a.page+1),disabled:a.page>=a.pages,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]})]})}export{R as default};
