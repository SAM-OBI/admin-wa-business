import{r as n,j as e}from"./index-Bh_G82eR.js";import{a as j}from"./admin.service-DANvCZDH.js";import{_ as h,F as b,x as i,j as x}from"./index.esm-BGr2I2xK.js";import"./iconBase-D0Fi-Wjo.js";function I(){const[a,u]=n.useState(null),[t,f]=n.useState(null),[N,v]=n.useState(!0),[d,g]=n.useState(0),[p,w]=n.useState(null),[y,o]=n.useState(null),m=async()=>{var s;try{const[l,r]=await Promise.all([j.getSecurityStats(),j.getSecurityMetrics()]),c=r!=null&&r.version?r.data:r==null?void 0:r.data;l!=null&&l.data&&u(l.data),c&&(f(c),w(new Date),((s=c.rbac)==null?void 0:s.mismatches)>15?o(`⚠️ High RBAC Mismatch Rate: ${c.rbac.mismatches}/min`):o(null)),g(0)}catch(l){console.error("Failed to fetch security data:",l),g(r=>r+1)}finally{v(!1)}};n.useEffect(()=>{m();const r=Math.min(3e5,3e4*Math.pow(2,d)),c=setTimeout(m,r);return()=>clearTimeout(c)},[d]);const S=s=>{switch(s){case"critical":return"bg-red-600 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-yellow-500 text-black";case"low":return"bg-blue-500 text-white";default:return"bg-gray-500 text-white"}},k=()=>e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 animate-pulse",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"})]}),e.jsx("div",{className:"h-12 w-12 bg-gray-200 rounded-full"})]})});if(N&&!a&&!t)return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Security Operations Center"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(s=>e.jsx(k,{},s))})]});const A=()=>{if(!p)return"Never";const s=Math.floor((new Date().getTime()-p.getTime())/1e3);return s<60?`${s}s ago`:s<3600?`${Math.floor(s/60)}m ago`:`${Math.floor(s/3600)}h ago`},C=[{title:"Failed Logins (24h)",value:(a==null?void 0:a.kpis.failedLogins24h)||0,icon:h,color:"text-blue-600",bg:"bg-blue-50"},{title:"RBAC Mismatches",value:(t==null?void 0:t.rbac.mismatches)||0,icon:b,color:"text-red-600",bg:"bg-red-50"},{title:"Argon2 Migrated",value:(t==null?void 0:t.argon2.migrated)||0,icon:i,color:"text-green-600",bg:"bg-green-50"},{title:"Legal Holds Active",value:(a==null?void 0:a.kpis.activeLegalHolds)||0,icon:x,color:"text-purple-600",bg:"bg-purple-50"}];return e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-600 p-4 rounded-r-lg flex items-center justify-between animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{className:"text-red-600 text-xl"}),e.jsx("span",{className:"text-red-800 font-semibold",children:y})]}),e.jsx("button",{onClick:()=>o(null),className:"text-red-600 hover:text-red-800 font-bold",children:"×"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(x,{className:"text-primary"})," Security Operations Center"]}),e.jsxs("p",{className:"text-gray-600 mt-1 text-sm flex items-center gap-2",children:["Real-time monitoring & threat detection",e.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full font-medium",children:["Last Sync: ",A()]}),d>0&&e.jsxs("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full font-medium",children:["Reconnecting... (",d,")"]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:m,className:"px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition text-sm font-medium flex items-center gap-2",children:[e.jsx(h,{})," Refresh Stream"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:C.map(s=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 flex items-center gap-4",children:[e.jsx("div",{className:`${s.bg} p-3 rounded-xl ${s.color}`,children:e.jsx(s.icon,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:s.title}),e.jsx("h3",{className:"text-2xl font-black text-gray-800 mt-1",children:s.value})]})]},s.title))}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(b,{className:"text-primary"})," Argon2 Migration Progress"]}),e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded ${(t==null?void 0:t.argon2.status)==="ACTIVE"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:(t==null?void 0:t.argon2.status)||"IDLE"})]}),e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-primary bg-primary/10",children:[Math.round((t==null?void 0:t.argon2.migrated)/((t==null?void 0:t.argon2.total)||1)*100),"% Complete"]})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-primary",children:[t==null?void 0:t.argon2.p95,"ms Latency (p95)"]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-gray-100",children:e.jsx("div",{style:{width:`${(t==null?void 0:t.argon2.migrated)/((t==null?void 0:t.argon2.total)||1)*100}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-primary transition-all duration-500"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center",children:[e.jsx("h2",{className:"font-bold text-gray-800",children:"RBAC Parity Stream"}),e.jsx("span",{className:"bg-red-100 text-red-700 text-[10px] font-black uppercase px-2 py-0.5 rounded",children:"Shadow Mode"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 text-[10px] font-black uppercase text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:"Resource"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"Mismatch"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"User"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"Time"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:(t==null?void 0:t.rbac.recent.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-10 text-center text-gray-400 text-sm",children:"No mismatches detected in last 50 events"})}):t==null?void 0:t.rbac.recent.map((s,l)=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm font-bold text-gray-800",children:s.path}),e.jsx("p",{className:"text-[10px] text-gray-400 font-mono",children:s.method})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-[10px] font-black bg-orange-100 text-orange-700 px-2 py-1 rounded",children:s.mismatchType})}),e.jsx("td",{className:"px-6 py-4 text-xs font-mono text-gray-500",children:s.userId||"System"}),e.jsx("td",{className:"px-6 py-4 text-xs text-gray-400",children:new Date(s.createdAt).toLocaleTimeString()})]},l))})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center",children:[e.jsx("h2",{className:"font-bold text-gray-800",children:"Threat Alerts Stream"}),e.jsx("span",{className:"bg-red-100 text-red-700 text-[10px] font-black uppercase px-2 py-0.5 rounded",children:"Live Detection"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 text-[10px] font-black uppercase text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:"Level"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"Event"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"Entity"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"Time"}),e.jsx("th",{className:"px-6 py-4 text-left",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:(a==null?void 0:a.recentAlerts.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[e.jsx(i,{size:40,className:"mb-4 text-green-400"}),e.jsx("p",{className:"font-medium",children:"All systems normal. No active threats detected."})]})})}):a==null?void 0:a.recentAlerts.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-[10px] font-black uppercase px-2 py-1 rounded ${S(s.severity)}`,children:s.severity})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm font-bold text-gray-800",children:s.type.replace(/_/g," ")}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:s.message})]}),e.jsx("td",{className:"px-6 py-4",children:s.userId?e.jsxs("div",{className:"text-xs",children:[e.jsx("p",{className:"font-bold text-gray-800",children:s.userId.name}),e.jsx("p",{className:"text-gray-400",children:s.userId.email})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"System/Unknown"})}),e.jsx("td",{className:"px-6 py-4 text-xs text-gray-500",children:new Date(s.createdAt).toLocaleString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{className:"text-primary hover:underline text-xs font-bold",children:"Investigate"})})]},s._id))})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(x,{className:"text-green-500"})," Compliance Status"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"NDPR Data Anonymizer"}),e.jsxs("span",{className:"text-green-600 font-bold flex items-center gap-1",children:[e.jsx(i,{})," Active"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Legal Hold Registry"}),e.jsxs("span",{className:"text-green-600 font-bold flex items-center gap-1",children:[e.jsx(i,{})," Synced"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Encryption Layer"}),e.jsxs("span",{className:"text-green-600 font-bold flex items-center gap-1",children:[e.jsx(i,{})," 256-bit"]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("p",{className:"text-[10px] font-black uppercase text-gray-400 mb-2",children:"Security Score"}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("span",{className:"text-3xl font-black text-gray-800",children:"98"}),e.jsx("span",{className:"text-sm font-bold text-green-500 mb-1",children:"/ 100"})]}),e.jsx("div",{className:"w-full h-2 bg-gray-100 rounded-full mt-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 w-[98%] rounded-full"})})]})]})]}),e.jsxs("div",{className:"bg-primary text-white rounded-2xl p-6 shadow-xl shadow-primary/20",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Automated Resilience"}),e.jsx("p",{className:"text-xs opacity-80 leading-relaxed mb-4",children:'Our background "Chaos Engine" runs daily to simulate network failures and database outages, ensuring 99.9% uptime for your vendors.'}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 rounded-xl p-3",children:[e.jsx(h,{className:"animate-pulse"}),e.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest",children:"Last Test: PASS (14m ago)"})]})]})]})]})]})}export{I as default};
