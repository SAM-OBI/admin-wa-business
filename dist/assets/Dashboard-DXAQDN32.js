var $=Object.defineProperty;var E=(r,a,t)=>a in r?$(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t;var u=(r,a,t)=>E(r,typeof a!="symbol"?a+"":a,t);import{r as i,j as e,L as c,P as A}from"./index-Bh_G82eR.js";import{y as L,z as F,A as v,B as N,C as T,e as D,f as b,d as f,m as G,x as M,h as q,D as I,E as V}from"./index.esm-BGr2I2xK.js";import{a as m}from"./admin.service-DANvCZDH.js";import{l as P}from"./logger-kjsKaDI_.js";import"./iconBase-D0Fi-Wjo.js";const d=i.memo(({value:r,prefix:a="",suffix:t="",label:l,trend:n,color:x="text-gray-900"})=>e.jsxs("div",{className:"flex flex-col","aria-label":`${l}: ${a}${r}${t}`,children:[e.jsxs("span",{className:`text-2xl font-black ${x} tracking-tight`,children:[a,r,t]}),n&&e.jsxs("span",{className:`text-[10px] font-black uppercase tracking-widest mt-1 ${n==="up"?"text-green-500":n==="down"?"text-red-500":"text-gray-400"}`,children:[n==="up"?"↑":n==="down"?"↓":"→"," Baseline"]})]})),g=i.memo(({status:r,label:a})=>{const t=()=>{switch(r){case"NORMAL":case"SUCCESS":return"bg-green-100 text-green-700 border-green-200";case"WARNING":case"PENDING":return"bg-amber-100 text-amber-700 border-amber-200";case"CRITICAL":return"bg-red-100 text-red-700 border-red-200";case"EMERGENCY":return"bg-red-600 text-white border-red-700 animate-pulse";default:return"bg-gray-100 text-gray-700 border-gray-200"}};return e.jsx("span",{role:"status",className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border ${t()}`,children:a||r})}),j=(r,a="NGN",t="en-NG")=>{try{return new Intl.NumberFormat(t,{style:"currency",currency:a,minimumFractionDigits:0,maximumFractionDigits:2}).format(r)}catch{return`${a==="NGN"?"₦":"$"}${r.toLocaleString()}`}},U=(r,a="relative")=>{const t=typeof r=="string"?new Date(r):r;if(isNaN(t.getTime()))return"Invalid Date";if(a==="relative"){const l=Math.floor((new Date().getTime()-t.getTime())/1e3);if(l<60)return"just now";if(l<3600)return`${Math.floor(l/60)}m ago`;if(l<86400)return`${Math.floor(l/3600)}h ago`;if(l<604800)return`${Math.floor(l/84400)}d ago`}return a==="full"?t.toLocaleString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})},B=i.memo(({data:r})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 transition-all hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("h2",{className:"font-black text-gray-800 uppercase tracking-widest flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:e.jsx(L,{className:"text-green-600"})}),"Treasury Health"]}),e.jsx(g,{status:r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Liquidity Score"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{value:r.liquidityScore,suffix:"%",label:"Liquidity Score",color:r.liquidityScore>80?"text-green-600":"text-amber-600"}),e.jsx("div",{className:"h-1.5 w-16 bg-gray-100 rounded-full overflow-hidden shrink-0",children:e.jsx("div",{className:`h-full ${r.liquidityScore>80?"bg-green-500":"bg-amber-500"}`,style:{width:`${r.liquidityScore}%`}})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Escrow Value"}),e.jsx(d,{value:j(r.totalEscrowValue),label:"Total Escrow"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Wallet Liability"}),e.jsx(d,{value:j(r.totalWalletLiability),label:"Wallet Liability"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Exposure Ratio"}),e.jsx(d,{value:r.exposureRatio.toFixed(3),label:"Exposure Ratio",color:r.exposureRatio>1?"text-red-600":"text-green-600",trend:r.exposureRatio>1?"up":"down"})]})]})]})),z=i.memo(({activities:r,getActivityIcon:a,getActivityText:t})=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden flex flex-col h-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-gray-50/30 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-black text-gray-900 uppercase tracking-widest",children:"Recent Activity"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-tight mt-0.5",children:"Live platform telemetry"})]}),e.jsx(c,{to:"/dashboard/audit-logs",className:"text-[10px] font-black text-blue-600 uppercase tracking-widest hover:text-blue-700 transition-colors",children:"View Logs"})]}),e.jsx("div",{className:"p-2 flex-1 overflow-y-auto max-h-[500px]",children:e.jsx("div",{className:"space-y-1",children:r.slice(0,8).map((l,n)=>e.jsxs("div",{className:"flex items-center gap-4 p-3.5 rounded-xl hover:bg-gray-50 transition-all border border-transparent hover:border-gray-100 group",children:[e.jsx("div",{className:"p-2.5 bg-white shadow-sm border border-gray-100 rounded-xl shrink-0 group-hover:scale-110 transition-transform",children:a(l.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-800 font-bold truncate leading-relaxed",children:t(l)}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-[10px] text-gray-400 font-black uppercase tracking-widest",children:[e.jsx(F,{size:10}),U(l.createdAt)]})]}),e.jsx(v,{size:14,className:"text-gray-300 opacity-0 group-hover:opacity-100 transition-opacity"})]},n))})})]}));class y extends i.Component{constructor(){super(...arguments);u(this,"state",{hasError:!1,error:null});u(this,"handleRetry",()=>{this.setState({hasError:!1,error:null})})}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,l){console.error(`[ErrorBoundary] ${this.props.name||"Component"} Error:`,t,l)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"p-8 rounded-2xl bg-red-50 border border-red-100 flex flex-col items-center text-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:e.jsx(N,{className:"text-red-600 text-2xl"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-gray-900 uppercase tracking-widest text-sm",children:"Module Fault"}),e.jsxs("p",{className:"text-xs text-red-700 font-bold uppercase tracking-tight mt-1",children:[this.props.name||"The component"," failed to initialize."]})]}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 bg-white border border-red-200 rounded-lg text-xs font-black text-red-600 uppercase tracking-widest hover:bg-red-600 hover:text-white transition-all shadow-sm",children:[e.jsx(T,{}),"Attempt Recovery"]})]}):this.props.children}}function Q(){const[r,a]=i.useState(null),[t,l]=i.useState(null),[n,x]=i.useState([]),[w,k]=i.useState(!0),p=i.useCallback(async()=>{try{const[s,o,h]=await Promise.allSettled([m.getDashboardStats(),m.getRecentActivity(),m.getTreasuryHealth()]);s.status==="fulfilled"&&a(s.value.data),o.status==="fulfilled"&&x(o.value.data),h.status==="fulfilled"&&l(h.value.data)}catch(s){P.error("Critical Dashboard Failure:",s)}finally{k(!1)}},[]);i.useEffect(()=>{p()},[p]);const S=s=>{switch(s){case"user":return e.jsx(V,{className:"text-blue-600"});case"vendor":return e.jsx(b,{className:"text-emerald-600"});case"product":return e.jsx(f,{className:"text-purple-600"});case"order":return e.jsx(I,{className:"text-orange-600"});case"complaint":return e.jsx(q,{className:"text-red-600"});default:return e.jsx(M,{className:"text-gray-400"})}},C=s=>{const o=s.data||{};switch(s.type){case"user":return`${o.name||"User"} registered`;case"vendor":return`${o.name||"Vendor"} joined platform`;case"product":return`${o.name||"Product"} added to catalog`;case"order":return`Order #${String(o.orderId||"").slice(-6)} processed`;case"complaint":return`Complaint filed: ${o.title||"Support Request"}`;default:return"System event recorded"}};if(w)return e.jsx(A,{});const R=[{title:"Registered Users",value:(r==null?void 0:r.totalUsers)||0,icon:D,color:"bg-blue-600",link:"/dashboard/users"},{title:"Active Vendors",value:(r==null?void 0:r.totalVendors)||0,icon:b,color:"bg-emerald-600",link:"/dashboard/vendors"},{title:"Global Catalog",value:(r==null?void 0:r.totalProducts)||0,icon:f,color:"bg-purple-600",link:"/dashboard/products"},{title:"Total Volume",value:(r==null?void 0:r.totalOrders)||0,icon:G,color:"bg-orange-600",link:"/dashboard/orders"}];return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 uppercase tracking-tighter",children:"Governance Hub"}),e.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest mt-1",children:"Real-time infrastructure & financial telemetry"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{status:"SUCCESS",label:"System Online"}),e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-ping"})]})]}),e.jsx(y,{name:"Treasury Monitor",children:t&&e.jsxs("div",{className:"space-y-4",children:[t.status!=="NORMAL"&&e.jsxs("div",{className:`p-4 rounded-xl border flex items-center gap-4 animate-pulse ${t.status==="EMERGENCY"?"bg-red-600 text-white border-red-700":t.status==="CRITICAL"?"bg-red-100 text-red-800 border-red-200":"bg-orange-100 text-orange-800 border-orange-200"}`,children:[e.jsx(N,{size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-black text-sm uppercase tracking-tight",children:["TREASURY ",t.status," ALERT"]}),e.jsxs("p",{className:"text-[10px] font-bold uppercase opacity-90",children:["Liquidity Score: ",t.liquidityScore,"% | Payout Gate Active"]})]}),e.jsx(c,{to:"/dashboard/financial-audit",className:"px-3 py-1.5 bg-black/10 hover:bg-black/20 rounded-lg text-[10px] font-black uppercase tracking-widest transition-colors",children:"Audit Ledger"})]}),e.jsx(B,{data:t})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:R.map(s=>e.jsx(c,{to:s.link,className:"block group",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{value:s.value.toLocaleString(),label:s.title,color:"text-gray-900"}),e.jsx("div",{className:`${s.color} p-3 rounded-xl shadow-lg shadow-black/5 transform group-hover:rotate-6 transition-transform`,children:e.jsx(s.icon,{className:"text-xl text-white"})})]}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-4 group-hover:text-blue-600 transition-colors",children:s.title})]})},s.title))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(y,{name:"Activity Registry",children:e.jsx(z,{activities:n,getActivityIcon:S,getActivityText:C})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-xs font-black text-gray-900 uppercase tracking-widest mb-6",children:"Action Center"}),e.jsx("div",{className:"space-y-3",children:[{label:"Verify Vendors",link:"/dashboard/vendors?status=pending",count:r==null?void 0:r.unverifiedVendors,color:"amber"},{label:"Review Complaints",link:"/dashboard/complaints",count:r==null?void 0:r.pendingComplaints,color:"red"},{label:"Security Protocols",link:"/dashboard/security",color:"blue"}].map((s,o)=>e.jsxs(c,{to:s.link,className:`flex items-center justify-between p-4 bg-${s.color}-50/50 border border-${s.color}-100 rounded-xl hover:bg-${s.color}-100 transition-all group`,children:[e.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest text-${s.color}-900`,children:s.label}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.count!==void 0&&s.count>0&&e.jsx("span",{className:`px-2 py-0.5 bg-${s.color}-200 text-${s.color}-900 text-[10px] font-black rounded-full`,children:s.count}),e.jsx(v,{className:`text-${s.color}-600 group-hover:translate-x-1 transition-transform`})]})]},o))})]}),((r==null?void 0:r.activeCourtCases)||0)>0&&e.jsx(c,{to:"/dashboard/court-cases",className:"block p-4 rounded-2xl border border-orange-100 bg-orange-50/30 hover:bg-orange-50 transition-all shadow-sm group",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2.5 bg-white rounded-xl shadow-sm border border-orange-100 group-hover:rotate-3 transition-transform",children:e.jsx(g,{status:"WARNING",label:"!"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-orange-900 uppercase tracking-widest",children:"Active Litigation"}),e.jsxs("p",{className:"text-[10px] font-bold text-orange-700 uppercase mt-1",children:[r==null?void 0:r.activeCourtCases," cases require mediation"]})]})]})})]})]})]})}export{Q as default};
