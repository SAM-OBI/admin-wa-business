import{r as a,j as e,d as x}from"./index-Bh_G82eR.js";import{o as m,C as p,U as f,g as j,A as y,S as w}from"./index.esm-BGr2I2xK.js";import{n as i}from"./index-B7n9UX3I.js";import{l as N}from"./logger-kjsKaDI_.js";import"./iconBase-D0Fi-Wjo.js";const L=()=>{const[s,d]=a.useState([]),[l,o]=a.useState(!0),[n,g]=a.useState(null),c=async()=>{o(!0);try{const t=await x.get("/admin/oversight/dlq");t.data.success&&d(t.data.data)}catch(t){N.error("Failed to fetch DLQ:",t),i.error("Failed to load Dead Letter Queue")}finally{o(!1)}},h=async()=>{if(window.confirm("Are you sure you want to clear all critical errors from the queue?"))try{await x.delete("/admin/oversight/dlq"),d([]),i.success("Dead Letter Queue cleared")}catch{i.error("Failed to clear queue")}};a.useEffect(()=>{c()},[]);const u=t=>{navigator.clipboard.writeText(JSON.stringify(t,null,2)),i.success("Error details copied to clipboard")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center text-red-500 shadow-sm border border-red-100",children:e.jsx(m,{size:20})}),"Dead Letter Queue"]}),e.jsx("p",{className:"text-gray-500 mt-1 text-sm font-medium",children:"Critical system failures requiring manual intervention."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:c,disabled:l,className:"p-3 bg-gray-50 text-gray-500 rounded-xl hover:bg-gray-100 transition-all border border-gray-100 shadow-sm disabled:opacity-50",title:"Refresh Queue",children:e.jsx(p,{className:l?"animate-spin":""})}),e.jsxs("button",{onClick:h,disabled:s.length===0,className:"flex items-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-xl font-bold text-xs uppercase tracking-widest transition-all shadow-md shadow-red-200 hover:bg-red-700 disabled:opacity-50",children:[e.jsx(f,{}),"Clear Queue"]})]})]}),s.length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-100 p-4 rounded-xl flex items-start gap-4 shadow-sm",children:[e.jsx(j,{className:"text-orange-500 mt-1 shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-800 font-bold text-[11px] uppercase tracking-widest",children:"Action Required"}),e.jsxs("p",{className:"text-orange-700/80 text-xs mt-1 leading-relaxed",children:["There are ",s.length," critical errors that failed processing. Investigate their reference IDs in the system logs to prevent data loss."]})]})]}),e.jsx("div",{className:"space-y-3",children:s.length===0&&!l?e.jsxs("div",{className:"bg-white py-16 rounded-2xl text-center border border-gray-100 shadow-sm flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-50 rounded-full flex items-center justify-center mb-6 text-green-500 shadow-sm border border-green-100",children:e.jsx(p,{size:28})}),e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-widest",children:"All Systems Nominal"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 font-medium",children:"The Dead Letter Queue is currently empty."})]}):s.map((t,r)=>e.jsxs("div",{className:`bg-white rounded-2xl border transition-all cursor-pointer overflow-hidden ${n===r?"border-red-400 shadow-lg ring-1 ring-red-400/20":"border-gray-100 hover:border-gray-200 shadow-sm"}`,onClick:()=>g(n===r?null:r),children:[e.jsxs("div",{className:"p-5 flex items-start gap-5",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-500 rounded-xl shrink-0 border border-red-100",children:e.jsx(m,{size:18})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-2",children:[e.jsx("h3",{className:"text-sm font-black text-gray-800 truncate leading-tight",children:t.error.message}),e.jsx("span",{className:"text-[9px] font-black uppercase text-gray-400 tracking-widest bg-gray-50 px-2 py-0.5 rounded-full border border-gray-100 whitespace-nowrap",children:new Date(t.timestamp).toLocaleString()})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-[10px] font-black text-gray-400 uppercase tracking-tight",children:[t.context.path&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(y,{className:"text-gray-300"}),e.jsx("span",{className:"text-gray-600",children:t.context.method})," ",t.context.path]}),t.context.referenceId&&e.jsxs("span",{className:"text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full",children:["REF: ",t.context.referenceId]})]})]})]}),n===r&&e.jsx("div",{className:"px-5 pb-5 pt-0 animate-in fade-in slide-in-from-top-2 duration-300",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl p-5 border border-gray-800 overflow-hidden relative group/code",children:[e.jsx("button",{onClick:b=>{b.stopPropagation(),u(t)},className:"absolute top-4 right-4 p-2 bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white rounded-lg transition-all",title:"Copy JSON",children:e.jsx(w,{size:12})}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black uppercase text-gray-500 tracking-widest mb-2",children:"Error Diagnostic"}),e.jsxs("pre",{className:"text-xs font-mono text-red-400 whitespace-pre-wrap leading-relaxed",children:[t.error.name,": ",t.error.message]})]}),t.error.stack&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black uppercase text-gray-500 tracking-widest mb-2",children:"Stack Trace"}),e.jsx("pre",{className:"text-[9px] font-mono text-gray-500 whitespace-pre-wrap max-h-40 overflow-y-auto custom-scrollbar-dark leading-relaxed",children:t.error.stack})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black uppercase text-gray-500 tracking-widest mb-2",children:"Operation Context"}),e.jsx("pre",{className:"text-xs font-mono text-blue-400 overflow-x-auto whitespace-pre leading-relaxed font-bold",children:JSON.stringify(t.context,null,2)})]})]})]})})]},r))})]})};export{L as default};
