import{u as C,j as e,r as d,N as y,L as A,a as L,b as O,O as P}from"./index-Bh_G82eR.js";import{F as $,a as U,b as w,c as I,d as N,e as _,f as v,g as z,h as k,i as T,j as S,k as H,l as q,m as u,n as W,o as B,p as V,q as M,r as D,s as G,t as Q,u as F}from"./index.esm-BGr2I2xK.js";import{a as f}from"./admin.service-DANvCZDH.js";import{F as J,a as K}from"./index.esm-DdX2Oo8i.js";import{A as X}from"./index-DtRD-HeV.js";import{m as Y}from"./proxy-B-BKHVQZ.js";import"./iconBase-D0Fi-Wjo.js";function Z({isOpen:t,onClose:n}){const l=C();if(!t)return null;const a=()=>{n(),l("/settings")};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-50 rounded-full -mr-16 -mt-16 opacity-50"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-purple-50 rounded-full -ml-12 -mb-12 opacity-50"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-6",children:e.jsx($,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Unlock Marketing Hub"}),e.jsx("p",{className:"text-gray-600 mb-8 max-w-sm",children:"Upgrade to a Pro plan to access advanced marketing tools, create discount codes, and boost your sales."}),e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx("button",{onClick:a,className:"w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5",children:"Upgrade Now"}),e.jsx("button",{onClick:n,className:"w-full py-3 px-4 text-gray-500 font-medium hover:text-gray-700 hover:bg-gray-50 rounded-xl transition-colors",children:"Maybe Later"})]})]})]})})}const ee=[{name:"Dashboard",to:"/dashboard",icon:I},{name:"Products",to:"/dashboard/products",icon:N},{name:"Users",to:"/dashboard/users",icon:_},{name:"Vendors",to:"/dashboard/vendors",icon:v},{name:"Orders",to:"/dashboard/orders",icon:v},{name:"Complaints",to:"/dashboard/complaints",icon:z},{name:"Court Cases",to:"/dashboard/court-cases",icon:k},{name:"Reviews",to:"/dashboard/reviews",icon:T},{name:"Risk Management",to:"/dashboard/risk-management",icon:S},{name:"Security SOC",to:"/dashboard/security",icon:S},{name:"Audit Logs",to:"/dashboard/audit-logs",icon:H},{name:"Account Consolidations",to:"/dashboard/consolidations",icon:q},{name:"App Feedback",to:"/dashboard/feedback",icon:k},{name:"Marketing",to:"/dashboard/marketing",icon:u},{name:"Promo Hub",to:"/dashboard/promo-hub",icon:u},{name:"Product Moderation",to:"/dashboard/product-moderation",icon:N},{name:"Newsletter",to:"/dashboard/newsletter",icon:W},{name:"Financial Audit",to:"/dashboard/financial-audit",icon:u},{name:"Escrow",to:"/dashboard/escrow",icon:$},{name:"Error Logs",to:"/dashboard/error-logs",icon:B},{name:"DLQ",to:"/dashboard/dlq",icon:V}];function te({isDesktopCollapsed:t,toggleDesktop:n,isMobileOpen:l,closeMobile:a}){const[x,c]=d.useState(!1);return e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 lg:hidden",onClick:a}),e.jsxs("div",{className:`bg-white border-r border-gray-100 flex flex-col fixed lg:static inset-y-0 left-0 z-50 transition-all duration-300 ease-in-out shadow-xl lg:shadow-none h-full
          ${l?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          ${t?"lg:w-20":"lg:w-64"}
          w-64
        `,children:[e.jsxs("div",{className:`p-4 border-b border-gray-100 flex items-center h-20 shrink-0 ${t?"justify-center":"justify-between"}`,children:[e.jsxs("div",{className:`${t?"hidden lg:hidden":"block"} flex flex-col overflow-hidden`,children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent whitespace-nowrap",children:"Admin Panel"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-medium whitespace-nowrap tracking-wide",children:"Wa Vendors"})]}),t&&e.jsx("div",{className:"hidden lg:flex items-center justify-center text-blue-600 font-bold text-xl",children:"A"}),e.jsx("button",{onClick:n,className:"hidden lg:flex p-1.5 rounded-lg hover:bg-gray-50 text-gray-400 hover:text-gray-600 transition",children:t?e.jsx(U,{size:20}):e.jsx(w,{size:20})}),e.jsx("button",{onClick:a,className:"lg:hidden p-1.5 rounded-lg hover:bg-gray-50 text-gray-500",children:e.jsx(w,{size:24})})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-4 space-y-1 scrollbar-thin scrollbar-thumb-gray-200",children:ee.map(i=>e.jsxs(y,{to:i.to,end:i.to==="/dashboard",onClick:m=>{window.innerWidth<1024&&a()},className:({isActive:m})=>`flex items-center gap-3 px-3 py-3 rounded-xl transition-all duration-200 group relative ${m?"bg-blue-50 text-blue-600 font-semibold shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} ${t?"lg:justify-center":""}`,title:t?i.name:"",children:[e.jsx(i.icon,{className:"text-lg shrink-0 transition-colors "}),e.jsx("span",{className:`whitespace-nowrap overflow-hidden transition-all duration-200 ${t?"lg:w-0 lg:opacity-0 hidden":"block"} `,children:i.name}),!t&&!1]},i.name))}),e.jsx("div",{className:"p-4 border-t border-gray-100 shrink-0",children:e.jsxs(y,{to:"/dashboard/settings",onClick:()=>window.innerWidth<1024&&a(),className:({isActive:i})=>`flex items-center gap-3 px-3 py-3 rounded-xl transition w-full ${i?"bg-blue-50 text-blue-600 font-semibold":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"} ${t?"lg:justify-center":""}`,title:t?"Settings":"",children:[e.jsx(M,{className:"text-lg shrink-0"}),e.jsx("span",{className:`${t?"lg:hidden":"block"}`,children:"Settings"})]})}),e.jsx(Z,{isOpen:x,onClose:()=>c(!1)})]})]})}const se=({user:t,logout:n,settingsPath:l="/settings"})=>{var m;const[a,x]=d.useState(!1),c=d.useRef(null);d.useEffect(()=>{const o=r=>{c.current&&!c.current.contains(r.target)&&x(!1)};return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[]);const i=o=>{if(!o)return"";const r=o.trim().split(/\s+/);return r.length===1?r[0].substring(0,1).toUpperCase()+".":(r[0][0]+"."+r[r.length-1][0]).toUpperCase()},b=o=>{if(!o)return"";const[r,h]=o.split("@");return!r||!h?o:r.length>3?`${r.substring(0,3)}..@${h}`:o};return e.jsxs("div",{className:"relative",ref:c,children:[e.jsxs("button",{onClick:()=>x(!a),className:"flex items-center gap-3 hover:bg-gray-50 p-2 rounded-lg transition-colors focus:outline-none",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:i(t==null?void 0:t.name)||"Admin"}),e.jsx("p",{className:"text-xs text-gray-500",children:b(t==null?void 0:t.email)})]}),e.jsxs("div",{className:"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold shadow-md relative",children:[((m=t==null?void 0:t.name)==null?void 0:m.charAt(0).toUpperCase())||e.jsx(D,{}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-white rounded-full p-0.5 shadow-sm border border-gray-100",children:e.jsx(G,{className:"text-gray-400 text-[10px]"})})]})]}),a&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden z-50 origin-top-right transform transition-all duration-200 ease-out",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 bg-gray-50/50",children:[e.jsx("p",{className:"text-sm font-bold text-gray-800",children:t==null?void 0:t.name}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]}),e.jsxs("div",{className:"p-2",children:[e.jsxs(A,{to:l,onClick:()=>x(!1),className:"flex items-center gap-3 px-3 py-2.5 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-colors w-full",children:[e.jsx(M,{className:"text-gray-400"}),"Account Settings"]}),e.jsxs("button",{onClick:()=>{x(!1),n()},className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors text-left",children:[e.jsx(Q,{className:"text-red-400"}),"Sign Out"]})]})]})]})};function ae({toggleMobileSidebar:t}){var p;const{admin:n,logout:l}=L(),[a,x]=d.useState([]),[c,i]=d.useState(0),[b,m]=d.useState(!1),[o,r]=d.useState(!0);d.useEffect(()=>{h();const s=setInterval(h,15e3);return()=>clearInterval(s)},[]);const h=async()=>{var s;try{const g=await f.getNotifications({limit:5});(s=g.data)!=null&&s.notifications&&(x(g.data.notifications),i(g.data.unreadCount||0))}catch(g){console.error("Failed to fetch notifications:",g)}finally{r(!1)}},R=async s=>{try{await f.markNotificationRead(s),h()}catch(g){console.error("Failed to mark read",g)}},E=async s=>{s.isRead||await R(s._id),m(!1)};return e.jsx("header",{className:"bg-white border-b border-gray-100/80 backdrop-blur-sm sticky top-0 z-30 px-4 lg:px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 text-gray-600",children:e.jsx(U,{size:24})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 tracking-tight",children:["Welcome back, ",(p=n==null?void 0:n.name)==null?void 0:p.split(" ")[0]]}),e.jsx("p",{className:"hidden md:block text-sm text-gray-500 font-medium",children:"Manage your platform efficiently"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>m(!b),className:"p-2.5 hover:bg-gray-100 rounded-xl transition relative group border border-transparent hover:border-gray-200",children:[e.jsx(F,{className:"text-xl text-gray-400 group-hover:text-gray-600 transition-colors"}),!o&&c>0&&e.jsx("span",{className:"absolute top-2 right-2 px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded-full border-2 border-white shadow-sm",children:c>9?"9+":c})]}),b&&e.jsxs("div",{className:"absolute right-0 mt-3 w-80 sm:w-96 bg-white rounded-2xl shadow-xl border border-gray-100 py-2 ring-1 ring-black/5 animate-in fade-in zoom-in-95 duration-200 origin-top-right",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-50 flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Notifications"}),e.jsx("button",{onClick:()=>{f.markAllNotificationsRead().then(h)},className:"text-xs text-blue-600 hover:text-blue-700 font-medium hover:underline",children:"Mark all read"})]}),a.length===0?e.jsxs("div",{className:"px-4 py-12 text-center text-gray-400 flex flex-col items-center",children:[e.jsx(F,{className:"text-3xl mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No new notifications"})]}):e.jsx("div",{className:"max-h-[28rem] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-200",children:a.map((s,g)=>{var j;return e.jsx(A,{to:((j=s.metadata)==null?void 0:j.link)||s.link||"#",onClick:()=>E(s),className:`block px-4 py-3.5 hover:bg-gray-50 transition border-b border-gray-50 last:border-0 ${s.isRead?"":'bg-blue-50/40 relative before:content-[""] before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-blue-500'}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full mt-0.5 shrink-0 ${s.isRead?"bg-gray-100 text-gray-500":"bg-blue-100 text-blue-600"}`,children:e.jsx(z,{className:"text-sm"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm text-gray-800 leading-snug ${s.isRead?"font-medium":"font-semibold"}`,children:s.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2 leading-relaxed",children:s.message}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1.5 font-medium tracking-wide",children:new Date(s.createdAt).toLocaleString()})]})]})},s._id||g)})})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200 mx-2 hidden md:block"}),e.jsx(se,{user:n,logout:l,settingsPath:"/settings"})]})]})})}function ne(){const{admin:t,isAuthenticated:n}=L(),[l,a]=d.useState(!1),x=C(),c=O(),i=(()=>{if(l)return!1;const o=sessionStorage.getItem("admin_2fa_banner_dismissed"),r=n&&t&&!t.isTwoFactorEnabled&&!o,h=c.pathname.includes("/settings");return!!r&&!h})(),b=()=>{sessionStorage.setItem("admin_2fa_banner_dismissed","true"),a(!0)},m=()=>{x("/dashboard/settings")};return e.jsx(X,{children:i&&e.jsx(Y.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-blue-600 text-white relative overflow-hidden z-[45]",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 sm:px-6 lg:px-8 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"bg-white/20 p-2 rounded-lg",children:e.jsx(J,{className:"text-xl"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("p",{className:"text-sm font-medium",children:[e.jsx("span",{className:"hidden sm:inline",children:"Secure Admin Account! "}),"Enable Two-Factor Authentication now."]})})]}),e.jsxs("div",{className:"flex items-center gap-4 ml-4",children:[e.jsx("button",{onClick:m,className:"whitespace-nowrap bg-white text-blue-600 px-4 py-1.5 rounded-lg text-sm font-bold hover:bg-blue-50 transition-colors",children:"Setup Now"}),e.jsx("button",{onClick:b,className:"text-white/60 hover:text-white transition-colors","aria-label":"Dismiss banner",children:e.jsx(K,{size:16})})]})]})})})}function me(){const[t,n]=d.useState(!1),[l,a]=d.useState(!1);return e.jsxs("div",{className:"flex h-screen bg-gray-50/50",children:[e.jsx(te,{isDesktopCollapsed:t,toggleDesktop:()=>n(!t),isMobileOpen:l,closeMobile:()=>a(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden w-full transition-all duration-300",children:[e.jsx(ne,{}),e.jsx(ae,{toggleMobileSidebar:()=>a(!l)}),e.jsx("main",{className:"flex-1 overflow-auto bg-gray-50/50 p-4 lg:p-6 scroll-smooth",children:e.jsx(P,{})})]})]})}export{me as default};
