import{r as d,d as m,j as e}from"./index-Bh_G82eR.js";import{d as w,J as R,c as $,P as I,K as M}from"./index.esm-BGr2I2xK.js";import{S as o}from"./sweetalert2.esm.all-B3GDCxSY.js";import"./iconBase-D0Fi-Wjo.js";function A(){const[y,N]=d.useState([]),[k,v]=d.useState(!0),[s,x]=d.useState({page:1,limit:20,total:0,pages:0}),[r,j]=d.useState({search:"",status:"all",store:""}),[b,P]=d.useState({total:0,active:0,disabled:0,flagged:0}),p=d.useCallback(async()=>{var t,i;v(!0);try{const a={page:s.page,limit:s.limit};r.search&&(a.search=r.search),r.status&&r.status!=="all"&&(a.status=r.status),r.store&&(a.store=r.store);const l=await m.get("/admin/products",{params:a});l.data.success&&(N(l.data.data.products),x(l.data.data.pagination))}catch(a){console.error("Failed to fetch products:",a),o.fire("Error",((i=(t=a.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to load products","error")}finally{v(!1)}},[s.page,s.limit,r]),h=d.useCallback(async()=>{try{const t=await m.get("/admin/products/stats");t.data.success&&P(t.data.data)}catch(t){console.error("Failed to fetch stats:",t)}},[]);d.useEffect(()=>{p(),h()},[p,h]);const F=async(t,i)=>{var l,c;const{value:a}=await o.fire({title:"Disable Product",html:`
        <div class="text-left">
          <p class="mb-4 text-sm text-gray-500">You are about to disable: <strong>${i}</strong></p>
          <select id="reason" class="swal2-input w-full mb-2">
            <option value="">Select Reason</option>
            <option value="Prohibited item">Prohibited item</option>
            <option value="Trademark violation">Trademark violation</option>
            <option value="Inappropriate content">Inappropriate content</option>
            <option value="Fraudulent listing">Fraudulent listing</option>
            <option value="Other">Other</option>
          </select>
          <textarea id="custom-reason" class="swal2-textarea w-full" placeholder="Additional notes..." rows="3"></textarea>
        </div>
      `,showCancelButton:!0,confirmButtonColor:"#ef4444",confirmButtonText:"Disable Product",preConfirm:()=>{var g,u;const n=(g=document.getElementById("reason"))==null?void 0:g.value,f=(u=document.getElementById("custom-reason"))==null?void 0:u.value;return n?{reason:f||n}:(o.showValidationMessage("Please select a reason"),!1)}});if(a)try{(await m.patch(`/admin/products/${t}/disable`,{reason:a.reason,notifyVendor:!0})).data.success&&(o.fire("Disabled!","Product has been disabled and vendor notified","success"),p(),h())}catch(n){o.fire("Error",((c=(l=n.response)==null?void 0:l.data)==null?void 0:c.message)||"Failed to disable product","error")}},S=async t=>{var a,l;if((await o.fire({title:"Enable Product?",text:"This will restore the product to active status",icon:"question",showCancelButton:!0,confirmButtonColor:"#10b981",confirmButtonText:"Yes, enable"})).isConfirmed)try{(await m.patch(`/admin/products/${t}/enable`)).data.success&&(o.fire("Enabled!","Product has been restored","success"),p(),h())}catch(c){o.fire("Error",((l=(a=c.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to enable product","error")}},C=async(t,i)=>{var l,c;const{value:a}=await o.fire({title:"Flag for Review",html:`
        <div class="text-left">
          <p class="mb-4 text-sm text-gray-500">Flag: <strong>${i}</strong></p>
          <select id="severity" class="swal2-input w-full mb-2">
            <option value="low">Low Priority</option>
            <option value="medium" selected>Medium Priority</option>
            <option value="high">High Priority</option>
          </select>
          <textarea id="reason" class="swal2-textarea w-full" placeholder="Reason for flagging..." rows="3" required></textarea>
        </div>
      `,showCancelButton:!0,confirmButtonColor:"#f59e0b",confirmButtonText:"Flag Product",preConfirm:()=>{var g,u;const n=(g=document.getElementById("severity"))==null?void 0:g.value,f=(u=document.getElementById("reason"))==null?void 0:u.value;return f?{severity:n,reason:f}:(o.showValidationMessage("Please provide a reason"),!1)}});if(a)try{(await m.patch(`/admin/products/${t}/flag`,a)).data.success&&(o.fire("Flagged!","Product flagged for review","success"),p())}catch(n){o.fire("Error",((c=(l=n.response)==null?void 0:l.data)==null?void 0:c.message)||"Failed to flag product","error")}},B=t=>{j({...r,search:t.target.value}),x({...s,page:1})},E=t=>{j({...r,status:t}),x({...s,page:1})};return k&&y.length===0?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg shadow-sm",children:e.jsx(w,{size:24})}),"Product Moderation"]}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Platform-wide product oversight and lifecycle management"})]}),e.jsx("div",{className:"flex bg-white p-1 rounded-xl border border-gray-100 shadow-sm",children:["all","active","disabled"].map(t=>e.jsx("button",{onClick:()=>E(t),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${r.status===t?"bg-blue-600 text-white shadow-lg shadow-blue-200":"text-gray-400 hover:text-gray-600"}`,children:t},t))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[{label:"Total Inventory",value:b.total,color:"text-gray-900",bg:"bg-white"},{label:"Market Active",value:b.active,color:"text-green-600",bg:"bg-green-50/30"},{label:"Policy Blocked",value:b.disabled,color:"text-red-600",bg:"bg-red-50/30"},{label:"Under Review",value:b.flagged,color:"text-amber-600",bg:"bg-amber-50/30"}].map(t=>e.jsxs("div",{className:`${t.bg} border border-gray-100 rounded-2xl p-6 shadow-sm`,children:[e.jsx("div",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:t.label}),e.jsx("div",{className:`text-2xl font-black ${t.color}`,children:t.value.toLocaleString()})]},t.label))}),e.jsx("div",{className:"bg-white rounded-2xl p-6 border border-gray-100 shadow-sm mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:r.search,onChange:B,placeholder:"Search by product name, vendor, or SKU...",className:"w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500/20 outline-none text-sm font-medium transition-all"})]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50/50 border-b border-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Product Reference"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Storefront"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest text-center",children:"In Stock"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Moderation"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:y.map(t=>{var i,a;return e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[(i=t.images)!=null&&i[0]?e.jsx("img",{src:t.images[0],className:"w-10 h-10 object-cover rounded-lg shadow-sm border border-gray-100"}):e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400",children:e.jsx(w,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-gray-800",children:t.name}),e.jsx("div",{className:"text-[10px] font-black text-blue-600 uppercase mt-0.5",children:((a=t.category)==null?void 0:a.name)||"Uncategorized"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"text-gray-300",size:12}),e.jsx("span",{className:"text-xs font-bold text-gray-600",children:t.store.name})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`text-xs font-black ${t.stock===0?"text-red-600":"text-gray-900"}`,children:t.stock})}),e.jsx("td",{className:"px-6 py-4",children:t.status==="disabled"||!t.isActive?e.jsx("span",{className:"px-3 py-1 rounded-full text-[9px] font-black uppercase bg-red-50 text-red-600 border border-red-100",children:"Blocked"}):e.jsx("span",{className:"px-3 py-1 rounded-full text-[9px] font-black uppercase bg-green-50 text-green-600 border border-green-100",children:"Live"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>C(t._id,t.name),className:"p-2 text-amber-500 hover:bg-amber-50 rounded-lg transition-colors border border-transparent hover:border-amber-100",title:"Flag for Manual Review",children:e.jsx(I,{size:14})}),t.status==="disabled"||!t.isActive?e.jsx("button",{onClick:()=>S(t._id),className:"px-4 py-1.5 text-[9px] font-black uppercase bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all shadow-md shadow-green-100",children:"Restore"}):e.jsxs("button",{onClick:()=>F(t._id,t.name),className:"px-4 py-1.5 text-[9px] font-black uppercase bg-red-50 text-red-600 border border-red-100 rounded-lg hover:bg-red-100 transition-all flex items-center gap-1.5",children:[e.jsx(M,{size:10})," Deactivate"]})]})})]},t._id)})})]})}),s.pages>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-50 flex items-center justify-between",children:[e.jsxs("div",{className:"text-[10px] font-black text-gray-400 uppercase",children:["Page ",s.page," of ",s.pages]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x({...s,page:s.page-1}),disabled:s.page===1,className:"px-4 py-1.5 text-[9px] font-black uppercase bg-gray-50 text-gray-600 rounded-lg border border-gray-100 disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:()=>x({...s,page:s.page+1}),disabled:s.page===s.pages,className:"px-4 py-1.5 text-[9px] font-black uppercase bg-gray-50 text-gray-600 rounded-lg border border-gray-100 disabled:opacity-50",children:"Next"})]})]})]})]})}export{A as default};
