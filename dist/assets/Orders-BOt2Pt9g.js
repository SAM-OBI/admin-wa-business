import{j as e,r as n,d as v}from"./index-Bh_G82eR.js";import{a as w}from"./admin.service-DANvCZDH.js";import{G as S,r as C,H as O,d as k,y as A,I as F,J as P,f as D}from"./index.esm-BGr2I2xK.js";import"./iconBase-D0Fi-Wjo.js";function $({order:t,onClose:d}){var m,c;const g=a=>{switch(a.toLowerCase()){case"delivered":return"bg-green-100 text-green-700";case"cancelled":return"bg-red-100 text-red-700";case"shipped":return"bg-blue-100 text-blue-700";default:return"bg-yellow-100 text-yellow-700"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Order Details"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Order #",t._id.slice(-8)]})]}),e.jsx("button",{onClick:d,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(S,{className:"text-xl text-gray-600"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Order Status"}),e.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${g(t.status)}`,children:t.status})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Payment Status"}),e.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${((m=t.paymentInfo)==null?void 0:m.status)==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:((c=t.paymentInfo)==null?void 0:c.status)||"Pending"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(C,{className:"text-gray-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Customer Information"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",t.user.name]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",t.user.email]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",t.user.phone]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Store"}),e.jsx("p",{className:"text-gray-700",children:"name"in t.store?t.store.name:t.store.storeName})]}),t.shippingAddress&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(O,{className:"text-gray-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Shipping Address"})]}),e.jsxs("p",{className:"text-gray-700",children:[t.shippingAddress.street,", ",t.shippingAddress.city,", ",t.shippingAddress.state,t.shippingAddress.zipCode&&` ${t.shippingAddress.zipCode}`]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(k,{className:"text-gray-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Order Items"})]}),e.jsx("div",{className:"space-y-3",children:t.products.map((a,x)=>{var p;return e.jsxs("div",{className:"flex items-center gap-4 bg-white border border-gray-200 rounded-lg p-4",children:[((p=a.product.images)==null?void 0:p[0])&&e.jsx("img",{src:a.product.images[0],alt:a.product.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.product.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantity: ",a.quantity]})]}),e.jsxs("p",{className:"font-semibold text-gray-900",children:["$",(a.price*a.quantity).toFixed(2)]})]},x)})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(A,{className:"text-gray-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Order Summary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",t.totalAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-gray-900 text-lg pt-2 border-t border-gray-300",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",t.totalAmount.toFixed(2)]})]})]})]}),t.timeline&&t.timeline.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(F,{className:"text-gray-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Order Timeline"})]}),e.jsx("div",{className:"space-y-3",children:t.timeline.map((a,x)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.description}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(a.timestamp).toLocaleString()})]})]},x))})]}),e.jsxs("div",{className:"text-sm text-gray-500 pt-4 border-t border-gray-200",children:["Order placed on ",new Date(t.createdAt).toLocaleString()]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end gap-3",children:e.jsx("button",{onClick:d,className:"px-6 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-medium",children:"Close"})})]})})}function _(){const[t,d]=n.useState([]),[g,m]=n.useState(!0),[c,a]=n.useState(""),[x,p]=n.useState(null),[r,f]=n.useState({page:1,limit:20,total:0,pages:1}),[o,u]=n.useState({status:"",paymentStatus:""}),h=n.useCallback(async(s=1)=>{var l;m(!0);try{const i=await w.getOrders({search:c,status:o.status,paymentStatus:o.paymentStatus,page:s,limit:r.limit});(l=i.data)!=null&&l.orders?(d(i.data.orders),f(i.data.pagination)):Array.isArray(i.data)?d(i.data):d([])}catch(i){console.error("Failed to fetch orders:",i)}finally{m(!1)}},[c,o.status,o.paymentStatus,r.limit]);n.useEffect(()=>{const s=setTimeout(()=>{h(1)},500);return()=>clearTimeout(s)},[h]);const y=s=>{s>=1&&s<=r.pages&&h(s)},N=async s=>{try{const l=await v.get(`/admin/orders/${s}/details`);l.data.data&&p(l.data.data)}catch(l){console.error("Failed to fetch order details:",l)}};return g&&t.length===0?e.jsx("div",{className:"p-6 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Orders Management"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Platform-wide order history"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("select",{value:o.status,onChange:s=>u(l=>({...l,status:s.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"Order Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:o.paymentStatus,onChange:s=>u(l=>({...l,paymentStatus:s.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"Payment Status"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by ID...",value:c,onChange:s=>a(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-48"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Order ID"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Store"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"Date"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[t.map(s=>{var l,i,j,b;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>N(s._id),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.orderId?`#${s.orderId}`:`#${s._id.slice(-6)}`})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:((l=s.user)==null?void 0:l.name)||"Guest"}),e.jsx("div",{className:"text-xs text-gray-500",children:(i=s.user)==null?void 0:i.email})]}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:((j=s.store)==null?void 0:j.name)||((b=s.store)==null?void 0:b.storeName)||"N/A"}),e.jsxs("td",{className:"px-6 py-4 font-medium text-gray-900",children:["$",s.totalAmount.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="delivered"?"bg-green-100 text-green-700":s.status==="cancelled"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-500 text-sm",children:new Date(s.createdAt).toLocaleDateString()})]},s._id)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No orders found."})})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:t.length})," of ",e.jsx("span",{className:"font-medium",children:r.total})," orders"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y(r.page-1),disabled:r.page<=1,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",r.page," of ",r.pages]}),e.jsx("button",{onClick:()=>y(r.page+1),disabled:r.page>=r.pages,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]}),x&&e.jsx($,{order:x,onClose:()=>p(null)})]})}export{_ as default};
