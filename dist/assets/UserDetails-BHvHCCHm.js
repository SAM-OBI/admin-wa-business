import{e as le,r as f,j as e,L as Q}from"./index-Bh_G82eR.js";import{a as o}from"./admin.service-DANvCZDH.js";import{w as ne,F as Y,a0 as Z,D as de,y as ce,i as ee,I as se,r as xe,v as oe,$ as me,H as ge,x as d,L as j,j as te}from"./index.esm-BGr2I2xK.js";import{S as c}from"./sweetalert2.esm.all-B3GDCxSY.js";import"./iconBase-D0Fi-Wjo.js";function be(){var b,p,N,y,w,S,k,V,A,F,L,R,C,D,U,H,$,O,P,I,E,T,_,B,z,M,J,W,q,G,X,K;const{id:m}=le(),[s,u]=f.useState(null),[ae,v]=f.useState(!0),g=f.useCallback(async()=>{v(!0);try{const t=await o.getUserById(m);u(t.data)}catch(t){console.error("Failed to fetch user details:",t)}finally{v(!1)}},[m]),l=async(t,a)=>{if(s)try{const n={[t]:a},h=await o.updateUserVerification(s._id,n);u(i=>i?{...i,verification:h.data.verification}:null)}catch(n){console.error("Failed to update verification:",n)}},re=async()=>{if(s&&confirm("Are you sure you want to unlock this user? This will reset their verification attempts."))try{const t=await o.updateUserVerification(s._id,{status:"unverified"});u(a=>a?{...a,verification:t.data.verification}:null)}catch(t){console.error("Failed to unlock user:",t)}},ie=async()=>{var t,a,n,h;if(s)if(s.legalHold){const{value:i}=await c.fire({title:"Remove Legal Hold",input:"textarea",inputLabel:"Justification for removing legal hold",inputPlaceholder:"Mandatory NDPR justification...",showCancelButton:!0,inputValidator:r=>{if(!r||r.length<5)return"Justification must be at least 5 characters!"}});if(i)try{await o.removeLegalHold(s._id,i),c.fire("Success","Legal hold removed.","success"),g()}catch(r){c.fire("Error",((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to remove legal hold","error")}}else{const{value:i}=await c.fire({title:"Active Legal Hold",text:"This will prevent the user from deleting their account or data.",input:"textarea",inputLabel:"Reason for legal hold",inputPlaceholder:"Law enforcement request, internal investigation, etc.",showCancelButton:!0,inputValidator:r=>{if(!r||r.length<5)return"Reason must be at least 5 characters!"}});if(i)try{await o.setLegalHold(s._id,i),c.fire("Success","Account placed under legal hold.","success"),g()}catch(r){c.fire("Error",((h=(n=r.response)==null?void 0:n.data)==null?void 0:h.message)||"Failed to set legal hold","error")}}};if(f.useEffect(()=>{m&&g()},[m,g]),ae)return e.jsx("div",{className:"p-6 flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!s)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"User not found"}),e.jsx(Q,{to:"/users",className:"text-blue-600 hover:underline mt-4 inline-block",children:"Back to Users"})]})});const x=(b=s.addresses)==null?void 0:b.find(t=>t.isDefault);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(Q,{to:"/users",className:"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[e.jsx(ne,{className:"mr-2"}),"Back to Users"]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:s.name}),e.jsx("p",{className:"text-gray-500 mt-1",children:s.email})]}),e.jsxs("div",{className:"flex gap-2",children:[s.legalHold&&e.jsxs("div",{className:"flex items-center gap-1 bg-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-bold",children:[e.jsx(Y,{})," Legal Hold Active"]}),((p=s.verification)==null?void 0:p.status)==="locked"&&e.jsxs("button",{onClick:re,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition flex items-center gap-2 text-sm",children:[e.jsx(Z,{})," Unlock Account"]}),e.jsxs("button",{onClick:ie,className:`px-4 py-2 rounded-lg transition flex items-center gap-2 text-sm font-medium ${s.legalHold?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200"}`,children:[s.legalHold?e.jsx(Z,{}):e.jsx(Y,{}),s.legalHold?"Remove Legal Hold":"Place Legal Hold"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:((N=s.orderStats)==null?void 0:N.totalOrders)||0})]}),e.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(de,{className:"text-blue-600",size:24})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Spent"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:["₦",(((y=s.orderStats)==null?void 0:y.totalSpent)||0).toLocaleString()]})]}),e.jsx("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ce,{className:"text-green-600",size:24})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Reviews Written"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:((w=s.reviewStats)==null?void 0:w.totalReviews)||0})]}),e.jsx("div",{className:"h-12 w-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(ee,{className:"text-yellow-600",size:24})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Account Age"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:[s.accountAge," days"]})]}),e.jsx("div",{className:"h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"text-purple-600",size:24})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Full Name"}),e.jsx("p",{className:"font-medium text-gray-800",children:s.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(oe,{className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-800",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-gray-800",children:s.phone||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Joined"}),e.jsx("p",{className:"font-medium text-gray-800",children:new Date(s.createdAt).toLocaleDateString()})]})]})]}),x&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ge,{className:"text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Default Address"}),e.jsxs("p",{className:"font-medium text-gray-800",children:[x.street,", ",x.city,", ",x.state,", ",x.country]})]})]})})]}),s.recentOrders&&s.recentOrders.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Recent Orders"}),e.jsx("div",{className:"space-y-3",children:s.recentOrders.map(t=>{var a;return e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-800",children:["Order #",t._id.slice(-6)]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:((a=t.store)==null?void 0:a.name)||"Unknown Store"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-gray-800",children:["₦",t.totalAmount.toLocaleString()]}),e.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full mt-1 ${t.status==="delivered"?"bg-green-100 text-green-700":t.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:t.status})]})]})},t._id)})})]}),s.recentReviews&&s.recentReviews.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Recent Reviews"}),e.jsx("div",{className:"space-y-3",children:s.recentReviews.map(t=>{var a;return e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ee,{className:"text-yellow-500 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"font-medium text-gray-800",children:(a=t.product)==null?void 0:a.name}),e.jsxs("span",{className:"text-sm font-semibold text-yellow-600",children:[t.rating,"/5"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.comment}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(t.createdAt).toLocaleDateString()})]})]})},t._id)})})]}),s.complaints&&s.complaints.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Complaints Filed"}),e.jsx("div",{className:"space-y-3",children:s.complaints.map(t=>e.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="resolved"?"bg-green-100 text-green-700":t.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:t.status})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(t.createdAt).toLocaleDateString()})]},t._id))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Account Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Role"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${s.role==="ADMIN"?"bg-purple-100 text-purple-700":s.role==="VENDORS"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.role})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Active Status"}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${s.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[s.isActive?e.jsx(d,{className:"mr-1"}):e.jsx(j,{className:"mr-1"}),s.isActive?"Active":"Suspended"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Email Verified"}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${s.isVerified?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[s.isVerified?e.jsx(d,{className:"mr-1"}):e.jsx(j,{className:"mr-1"}),s.isVerified?"Verified":"Unverified"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Verification Status"}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${((S=s.verification)==null?void 0:S.status)==="verified"?"bg-green-100 text-green-700":((k=s.verification)==null?void 0:k.status)==="pending"?"bg-yellow-100 text-yellow-700":((V=s.verification)==null?void 0:V.status)==="rejected"?"bg-red-100 text-red-700":((A=s.verification)==null?void 0:A.status)==="locked"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-700"}`,children:[((F=s.verification)==null?void 0:F.status)==="verified"&&e.jsx(d,{className:"mr-1"}),((L=s.verification)==null?void 0:L.status)==="pending"&&e.jsx(d,{className:"mr-1"}),((R=s.verification)==null?void 0:R.status)==="rejected"&&e.jsx(j,{className:"mr-1"}),((C=s.verification)==null?void 0:C.status)==="locked"&&e.jsx(te,{className:"mr-1"}),((D=s.verification)==null?void 0:D.status)||"unverified"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Verification Status"}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${((U=s.verification)==null?void 0:U.status)==="verified"?"bg-green-100 text-green-700":((H=s.verification)==null?void 0:H.status)==="pending"?"bg-yellow-100 text-yellow-700":(($=s.verification)==null?void 0:$.status)==="rejected"?"bg-red-100 text-red-700":((O=s.verification)==null?void 0:O.status)==="locked"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-700"}`,children:[((P=s.verification)==null?void 0:P.status)==="verified"&&e.jsx(d,{className:"mr-1"}),((I=s.verification)==null?void 0:I.status)==="pending"&&e.jsx(d,{className:"mr-1"}),((E=s.verification)==null?void 0:E.status)==="rejected"&&e.jsx(j,{className:"mr-1"}),((T=s.verification)==null?void 0:T.status)==="locked"&&e.jsx(te,{className:"mr-1"}),((_=s.verification)==null?void 0:_.status)||"unverified"]})]}),s.verification&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm block",children:"BVN"}),e.jsx("span",{className:"font-medium text-gray-800 text-sm",children:((B=s.governmentId)==null?void 0:B.bvn)||"Not Provided"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs ${s.verification.bvnVerified?"text-green-600":"text-gray-400"}`,children:s.verification.bvnVerified&&"✓ Verified"}),!s.verification.bvnVerified&&((z=s.governmentId)==null?void 0:z.bvn)&&e.jsx("button",{onClick:()=>l("bvn",!0),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100 border border-green-200",children:"Verify"}),s.verification.bvnVerified&&e.jsx("button",{onClick:()=>l("bvn",!1),className:"text-xs text-red-500 hover:underline",children:"Revoke"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm block",children:"NIN"}),e.jsx("span",{className:"font-medium text-gray-800 text-sm",children:((M=s.governmentId)==null?void 0:M.nin)||"Not Provided"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs ${s.verification.ninVerified?"text-green-600":"text-gray-400"}`,children:s.verification.ninVerified&&"✓ Verified"}),!s.verification.ninVerified&&((J=s.governmentId)==null?void 0:J.nin)&&e.jsx("button",{onClick:()=>l("nin",!0),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100 border border-green-200",children:"Verify"}),s.verification.ninVerified&&e.jsx("button",{onClick:()=>l("nin",!1),className:"text-xs text-red-500 hover:underline",children:"Revoke"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm block",children:"Voter's Card"}),e.jsx("span",{className:"font-medium text-gray-800 text-sm",children:((W=s.governmentId)==null?void 0:W.votersCard)||"Not Provided"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs ${s.verification.votersVerified?"text-green-600":"text-gray-400"}`,children:s.verification.votersVerified&&"✓ Verified"}),!s.verification.votersVerified&&((q=s.governmentId)==null?void 0:q.votersCard)&&e.jsx("button",{onClick:()=>l("voters",!0),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100 border border-green-200",children:"Verify"}),s.verification.votersVerified&&e.jsx("button",{onClick:()=>l("voters",!1),className:"text-xs text-red-500 hover:underline",children:"Revoke"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Activity Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Account Age"}),e.jsxs("span",{className:"font-bold text-gray-800",children:[s.accountAge," days"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Orders"}),e.jsx("span",{className:"font-bold text-gray-800",children:((G=s.orderStats)==null?void 0:G.totalOrders)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Completed Orders"}),e.jsx("span",{className:"font-bold text-green-600",children:((X=s.orderStats)==null?void 0:X.completedOrders)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Spent"}),e.jsxs("span",{className:"font-bold text-gray-800",children:["₦",(((K=s.orderStats)==null?void 0:K.totalSpent)||0).toLocaleString()]})]}),s.reviewStats&&s.reviewStats.totalReviews>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-100",children:[e.jsx("span",{className:"text-gray-600",children:"Reviews Written"}),e.jsx("span",{className:"font-bold text-gray-800",children:s.reviewStats.totalReviews})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Avg Rating Given"}),e.jsxs("span",{className:"font-bold text-yellow-600",children:[s.reviewStats.averageRating.toFixed(1),"/5"]})]})]})]})]}),s.addresses&&s.addresses.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Saved Addresses"}),e.jsx("div",{className:"space-y-3",children:s.addresses.map((t,a)=>e.jsxs("div",{className:`p-3 rounded-lg ${t.isDefault?"bg-blue-50 border border-blue-200":"bg-gray-50"}`,children:[t.isDefault&&e.jsx("span",{className:"text-xs font-semibold text-blue-600 mb-1 block",children:"DEFAULT"}),e.jsx("p",{className:"text-sm text-gray-700",children:t.street}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.city,", ",t.state]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.country})]},a))})]})]})]})]})}export{be as default};
