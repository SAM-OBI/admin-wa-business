import{r as i,d as y,j as e}from"./index-Bh_G82eR.js";import{V as j,B as f,R as b}from"./index.esm-BGr2I2xK.js";import"./iconBase-D0Fi-Wjo.js";function S(){const[l,d]=i.useState([]),[g,o]=i.useState(!0),[t,u]=i.useState({page:1,limit:20,total:0,pages:1}),[n,x]=i.useState({severity:"",action:"",userType:""}),c=i.useCallback(async(s=1)=>{var a;o(!0);try{const r=await y.get("/admin/audit-logs",{params:{...n,page:s,limit:t.limit}});(a=r.data.data)!=null&&a.logs?(d(r.data.data.logs),u(r.data.data.pagination)):d([])}catch(r){console.error("Failed to fetch audit logs:",r),d([])}finally{o(!1)}},[n,t.limit]);i.useEffect(()=>{c(1)},[c]);const p=s=>{s>=1&&s<=t.pages&&c(s)},h=s=>{switch(s){case"critical":return e.jsx(b,{className:"text-red-500"});case"warning":return e.jsx(f,{className:"text-yellow-500"});default:return e.jsx(j,{className:"text-blue-500"})}};return g&&l.length===0?e.jsx("div",{className:"p-6 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Audit Logs"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"System activity and security logs"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("select",{value:n.severity,onChange:s=>x(a=>({...a,severity:s.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Severities"}),e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"warning",children:"Warning"}),e.jsx("option",{value:"critical",children:"Critical"})]}),e.jsxs("select",{value:n.userType,onChange:s=>x(a=>({...a,userType:s.target.value})),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Users"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"vendor",children:"Vendor"}),e.jsx("option",{value:"user",children:"User"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Severity"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Action"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"Date"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[l.map(s=>{var a,r,m;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2 capitalize",children:[h(s.severity),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.severity})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs font-mono text-gray-700",children:s.action})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((a=s.user)==null?void 0:a.name)||"System"}),e.jsx("div",{className:"text-xs text-gray-500",children:((r=s.user)==null?void 0:r.email)||((m=s.user)==null?void 0:m.role)})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.description}),e.jsx("td",{className:"px-6 py-4 text-right text-sm text-gray-500",children:new Date(s.createdAt).toLocaleString()})]},s._id)}),l.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No audit logs found matching criteria."})})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:l.length})," of ",e.jsx("span",{className:"font-medium",children:t.total})," logs"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p(t.page-1),disabled:t.page<=1,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",t.page," of ",t.pages]}),e.jsx("button",{onClick:()=>p(t.page+1),disabled:t.page>=t.pages,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]})]})}export{S as default};
