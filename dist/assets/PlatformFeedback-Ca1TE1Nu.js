import{r as a,j as e}from"./index-Bh_G82eR.js";import{a as x}from"./admin.service-DANvCZDH.js";import{Q as y,h as v,I as N,r as w}from"./index.esm-BGr2I2xK.js";import{S as u}from"./sweetalert2.esm.all-B3GDCxSY.js";import"./iconBase-D0Fi-Wjo.js";function _(){const[n,p]=a.useState([]),[g,c]=a.useState(!0),[l,m]=a.useState(""),[t,o]=a.useState(1),[d,b]=a.useState(1);a.useEffect(()=>{i()},[t,l]);const i=async()=>{c(!0);try{const s=await x.getFeedbacks({page:t,limit:10,type:l});s.data&&(p(s.data.feedbacks),b(s.data.pagination.pages))}catch{console.error("Failed to fetch feedback details")}finally{c(!1)}},h=async(s,r)=>{try{await x.updateFeedbackStatus(s,r),i(),u.fire({icon:"success",title:"Updated",text:"Feedback status updated",timer:1500,showConfirmButton:!1})}catch{u.fire("Error","Failed to update status","error")}},f=s=>{switch(s){case"new":return"bg-blue-100 text-blue-800";case"read":return"bg-gray-100 text-gray-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"App Feedback"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Review user and vendor feedback about the platform"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"text-gray-400"}),e.jsxs("select",{value:l,onChange:s=>m(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"bug",children:"Bug Report"}),e.jsx("option",{value:"feature_request",children:"Feature Request"})]})]})]}),g?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:n.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:[e.jsx(v,{className:"mx-auto text-4xl text-gray-300 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No feedback found"})]}):n.map(s=>{var r;return e.jsx("div",{className:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm hover:shadow-md transition",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-600 text-xl font-bold",children:s.rating}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold uppercase tracking-wider ${s.category==="bug"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:s.category.replace("_"," ")}),e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(N,{})," ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsx("p",{className:"text-gray-800 font-medium whitespace-pre-wrap",children:s.comment}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-xs text-gray-500",children:[e.jsx(w,{}),e.jsx("span",{className:"font-semibold",children:((r=s.user)==null?void 0:r.name)||"Unknown User"}),e.jsxs("span",{className:"bg-gray-100 px-1.5 rounded text-gray-600 capitalize",children:["(",s.userType,")"]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold uppercase ${f(s.status)}`,children:s.status.replace("_"," ")}),e.jsxs("select",{value:s.status,onChange:j=>h(s._id,j.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1 outline-none cursor-pointer hover:border-blue-400",children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"read",children:"Read"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"resolved",children:"Resolved"})]})]})]})},s._id)})}),e.jsxs("div",{className:"flex justify-center mt-6 gap-2",children:[e.jsx("button",{disabled:t===1,onClick:()=>o(s=>Math.max(1,s-1)),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsxs("span",{className:"px-3 py-1 text-gray-500",children:["Page ",t," of ",d]}),e.jsx("button",{disabled:t===d,onClick:()=>o(s=>Math.min(d,s+1)),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})}export{_ as default};
