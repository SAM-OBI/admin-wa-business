import{r as i,d as N,j as e}from"./index-Bh_G82eR.js";import{a as v}from"./admin.service-DANvCZDH.js";import{G as w,z as C,k as S}from"./index.esm-BGr2I2xK.js";import{S as p}from"./sweetalert2.esm.all-B3GDCxSY.js";import"./iconBase-D0Fi-Wjo.js";function k({caseId:d,onClose:c,onUpdate:b}){var m;const[t,x]=i.useState(null),[y,g]=i.useState(!0),[r,a]=i.useState("details");i.useState(()=>{u()});const u=async()=>{try{const s=await N.get(`/admin/court-cases/${d}/details`);x(s.data.data)}catch(s){console.error("Failed to fetch case details:",s),p.fire("Error","Failed to load case details","error")}finally{g(!1)}},o=async()=>{var l,n;const{value:s}=await p.fire({title:"Record Judgment",html:`
        <select id="ruling" class="swal2-input">
          <option value="">Select Ruling</option>
          <option value="favor_plaintiff">Favor Plaintiff</option>
          <option value="favor_defendant">Favor Defendant</option>
          <option value="partial">Partial</option>
        </select>
        <textarea id="decision" class="swal2-textarea" placeholder="Decision details..."></textarea>
        <input id="compensation" type="number" class="swal2-input" placeholder="Compensation (optional)">
      `,focusConfirm:!1,showCancelButton:!0,preConfirm:()=>{const h=document.getElementById("ruling").value,f=document.getElementById("decision").value,j=document.getElementById("compensation").value;return!h||!f?(p.showValidationMessage("Ruling and decision are required"),!1):{ruling:h,decision:f,compensation:j?parseFloat(j):void 0}}});if(s)try{await N.post(`/admin/court-cases/${d}/judgment`,s),p.fire("Success","Judgment recorded successfully","success"),u(),b()}catch(h){p.fire("Error",((n=(l=h.response)==null?void 0:l.data)==null?void 0:n.message)||"Failed to record judgment","error")}};return y?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Loading case details..."})]})}):t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.caseNumber}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t.plaintiff.name," vs ",t.defendant.name]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(w,{className:"text-xl text-gray-600"})})]}),e.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex px-6",children:[e.jsx("button",{onClick:()=>a("details"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${r==="details"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Case Details"}),e.jsxs("button",{onClick:()=>a("evidence"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${r==="evidence"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Evidence (",((m=t.evidence)==null?void 0:m.length)||0,")"]}),e.jsx("button",{onClick:()=>a("timeline"),className:`px-4 py-3 text-sm font-medium border-b-2 transition ${r==="timeline"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Timeline"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[r==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"Status"}),e.jsx("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full bg-blue-100 text-blue-700 capitalize",children:t.status.replace("_"," ")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Plaintiff"}),e.jsx("p",{className:"text-gray-700",children:t.plaintiff.name}),e.jsx("p",{className:"text-sm text-gray-500",children:t.plaintiff.email})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Defendant"}),e.jsx("p",{className:"text-gray-700",children:t.defendant.name}),e.jsx("p",{className:"text-sm text-gray-500",children:t.defendant.email})]})]}),t.judgment?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(C,{className:"text-green-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Judgment"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Ruling:"})," ",t.judgment.ruling.replace("_"," ")]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Decision:"})," ",t.judgment.decision]}),t.judgment.compensation&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Compensation:"})," $",t.judgment.compensation]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Judged on ",new Date(t.judgment.judgedAt).toLocaleDateString()]})]})]}):e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:[e.jsx("p",{className:"text-gray-700 mb-3",children:"No judgment recorded yet"}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Record Judgment"})]})]}),r==="evidence"&&e.jsx("div",{className:"space-y-4",children:t.evidence&&t.evidence.length>0?t.evidence.map((s,l)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded bg-gray-200 text-gray-700 capitalize",children:s.type.replace("_"," ")}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Uploaded by ",s.uploadedBy]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.uploadedAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-gray-700 mb-2",children:s.description}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:"View Evidence"})]},l)):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No evidence uploaded yet"})}),r==="timeline"&&e.jsx("div",{className:"space-y-4",children:t.timeline&&t.timeline.length>0?t.timeline.map((s,l)=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1 pb-4 border-b border-gray-200 last:border-0",children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.action}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-500",children:[e.jsx("span",{children:s.actor.name}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:s.actorType}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(s.date).toLocaleString()})]})]})]},l)):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No timeline events yet"})})]}),e.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end gap-3",children:e.jsx("button",{onClick:c,className:"px-6 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-medium",children:"Close"})})]})}):null}function A(){const[d,c]=i.useState([]),[b,t]=i.useState(!0),[x,y]=i.useState(""),[g,r]=i.useState(null),[a,u]=i.useState({page:1,limit:20,total:0,pages:1}),o=i.useCallback(async(s=1)=>{var l;t(!0);try{const n=await v.getCourtCases({status:x,page:s,limit:a.limit});(l=n.data)!=null&&l.cases?(c(n.data.cases),u(n.data.pagination)):Array.isArray(n.data)?c(n.data):c([])}catch(n){console.error("Failed to fetch court cases:",n)}finally{t(!1)}},[x,a.limit]);i.useEffect(()=>{o(1)},[o]);const m=s=>{s>=1&&s<=a.pages&&o(s)};return b?e.jsx("div",{className:"p-6 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Court Cases"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Legal disputes and arbitrations"})]}),e.jsx("div",{children:e.jsxs("select",{value:x,onChange:s=>y(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"",children:"All Costs"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Case Number"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Parties"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Filing Date"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[d.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>r(s._id),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:s.caseNumber})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.plaintiff}),e.jsx("span",{className:"text-gray-500 mx-2",children:"vs"}),e.jsx("span",{className:"font-medium",children:s.defendant})]})}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:new Date(s.filingDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="open"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium",onClick:l=>{l.stopPropagation(),r(s._id)},children:"View Details"})})]},s._id)),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No court cases found."})})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:d.length})," of ",e.jsx("span",{className:"font-medium",children:a.total})," cases"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m(a.page-1),disabled:a.page<=1,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700",children:["Page ",a.page," of ",a.pages]}),e.jsx("button",{onClick:()=>m(a.page+1),disabled:a.page>=a.pages,className:"px-3 py-1 border border-gray-300 rounded-lg text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]}),g&&e.jsx(k,{caseId:g,onClose:()=>r(null),onUpdate:()=>{r(null),o(a.page)}})]})}export{A as default};
